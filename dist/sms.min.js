!function(){angular.module("ysSmsVerification.config",[]).value("ysSmsVerification.config",{debug:!0}),angular.module("internationalPhoneNumber",[]).directive("internationalPhoneNumber",function(){return{restrict:"A",require:"^ngModel",link:function(scope,element,attrs,ctrl){var handleWhatsSupposedToBeAnArray,options,read;return read=function(){return ctrl.$setViewValue(element.val())},handleWhatsSupposedToBeAnArray=function(e){return"object"==typeof e?e:e.toString().replace(/[ ]/g,"").split(",")},options={autoFormat:!0,autoHideDialCode:!0,defaultCountry:"",nationalMode:!1,numberType:"",onlyCountries:void 0,preferredCountries:["us","gb"],responsiveDropdown:!1,utilsScript:""},angular.forEach(options,function(value,key){var option;return option=eval("attrs."+key),angular.isDefined(option)?"preferredCountries"===key?options.preferredCountries=handleWhatsSupposedToBeAnArray(option):"onlyCountries"===key?options.onlyCountries=handleWhatsSupposedToBeAnArray(option):options[key]="boolean"==typeof value?"true"===option:option:void 0}),element.intlTelInput(options),scope.country=element.intlTelInput("getSelectedCountryData"),options.utilsScript||element.intlTelInput("loadUtils","bower_components/intl-tel-input/lib/libphonenumber/build/utils.js"),ctrl.$parsers.push(function(e){return e?e.replace(/[^\d]/g,""):e}),ctrl.$parsers.push(function(e){return e?ctrl.$setValidity("international-phone-number",element.intlTelInput("isValidNumber")):(e="",delete ctrl.$error["international-phone-number"]),e}),element.on("blur keyup change",function(){return scope.$apply(read)}),element.on("$destroy",function(){return element.off("blur keyup change")})}}}),angular.module("ysSmsVerification.directives",[]),angular.module("ysSmsVerification.filters",[]),angular.module("ysSmsVerification.services",[]),angular.module("ysSmsVerification.templates",[]),angular.module("ysSmsVerification",["ysSmsVerification.config","ysSmsVerification.directives","ysSmsVerification.filters","ysSmsVerification.services","ysSmsVerification.templates","ngSanitize","internationalPhoneNumber","timer"]),angular.module("ysSmsVerification.templates").run(["$templateCache",function(e){e.put("mobile-number.html",'<form name="mobileNumberForm" ng-submit=\'submitNumber(phoneNumber)\' >\n	<div ng-if="fail" class="alert alert-danger text-center">\n		Something went wrong, make sure you entered a valid phone number, or try a different one\n	</div>\n	<div class=\'form-group\'>\n		<input class=\'form-control input-lg\'\n			type="tel"\n			preferred-countries="ps, sa,jo,kw"\n			responsive-dropdown=\'true\'\n			default-country="ps"\n			international-phone-number\n			name="phoneNumber"\n			ng-model="phoneNumber"\n			ng-required="true" />\n	</div>\n	<div class=\'form-group\'>\n		<button type=\'submit\'  class=\'btn btn-primary btn-block btn-lg\'>Submit</button>\n	</div>\n</form>\n'),e.put("sms-verification.html",'\n<div class="alert alert-info text-center"  ng-show="phoneNumber">\n<strong>Mobile Number</strong> : {{ phoneNumber }}\n</div>\n\n<mobile-number>\n</mobile-number>\n\n<verification-code>\n</verification-code>\n'),e.put("verification-code.html",'<form name="verificationCodeForm" ng-submit=\'submitCode(code)\' >\n	<div class=\'form-group has-feedback\'>\n		<input class=\'form-control input-lg\' type=\'text\' name="code" ng-model=\'code\' ng-minlength="5" ng-maxlength="7" ng-required=\'true\' placeholder=\'Verification Code \' style=" font-size: 30px;height: 70px;letter-spacing: 7px;font-weight: bold;font-family: monospace;text-align: center; " />\n		<span class="glyphicon glyphicon-lock form-control-feedback text-danger" style="width: 50px;height: 50px;line-height: 25px;font-size: 27px;right: 10px;" /></span>\n	</div>\n	<p class="text-center">\n		You should receive verification code within : <timer autostart="false" countdown="5" max-time-unit="\'minute\'" interval="1000" finish-callback="timerFinished()">{{mminutes}} minute{{minutesS}}, {{sseconds}} second{{secondsS}}</timer>\n	</p>\n	<p class="text-center" ng-show="timeout">\n		Didn\'t receive code ? <a ng-click="tryAgain()" href="">Try a different number</a>\n	</p>\n	<div class=\'form-group\'>\n		<button type=\'submit\' class=\'btn btn-primary btn-block btn-lg\'>Submit</button>\n	</div>\n</form>\n')}]);var Deez=angular.module("ysSmsVerification.directives",[]);Deez.directive("ysSmsVerification",["$templateCache","$compile",function(e,n){return{link:function(){},controller:function(e){var n=this;this.screens={},this.addScreen=function(e,t){n.screens[e]=t},this.activateScreen=function(e){return n.screens[e]?(angular.forEach(n.screens,function(e){e.active=!1}),n.screens[e].active=!0,void 0):0},e.$on("mobileNumber:success",function(t,i){e.phoneNumber=i.phoneNumber,e.country=i.countryCode,n.activateScreen("verificationCode"),e.$broadcast("timer-start")}),e.$on("verificationCode:success",function(t,i){e.code=i,n.activateScreen("success")}),e.$on("verificationCode:tryagain",function(){n.activateScreen("mobileNumber")})},link:function(t,i,r){var o=r.templateUrl?e.get(r.templateUrl):e.get("sms-verification.html");i.html(o),n(i.contents())(t)},scope:!0,transclude:!0}}]),Deez.directive("mobileNumber",["$templateCache","$compile",function(e,n){return{restrict:"EA",require:"^ysSmsVerification",controller:function(e,n,t,i){e.active=!0,e.submitNumber=function(n){var t=$('input[name="phoneNumber"]').intlTelInput("getSelectedCountryData");e.mobileNumberForm.$valid&&i.send(n).then(function(n){"ok"==n.status?e.$emit("mobileNumber:success",{countryCode:t,phoneNumber:e.mobileNumberForm.phoneNumber.$viewValue}):(e.fail=!0,e.$emit("mobileNumber:fail"))},function(){e.fail=!0,e.$emit("mobileNumber:fail")})}},scope:!0,link:function(t,i,r,o){var a=r.templateUrl?e.get(r.templateUrl):e.get("mobile-number.html");a='<div ng-show="active"> '+a+" </div>",i.html(a),n(i.contents())(t),o.addScreen("mobileNumber",t)},transclude:!0}}]),Deez.directive("verificationCode",["$templateCache","$compile",function(e,n){return{restrict:"EA",require:"^ysSmsVerification",scope:{},transclude:!0,controller:function(e){e.submitCode=function(){var n=e.verificationCodeForm.$valid;n?e.$emit("verificationCode:success",e.verificationCodeForm.code.$viewValue):console.log("INVALID CODE")},e.timerFinished=function(){e.timeout=!0,e.$emit("verificationCode:timeout",e),e.$apply()},e.tryAgain=function(){e.timeout=!1,e.$emit("verificationCode:tryagain")}},link:function(t,i,r,o){var a=r.templateUrl?e.get(r.templateUrl):e.get("verification-code.html");a='<div ng-show="active"> '+a+" </div>",i.html(a),n(i.contents())(t),o.addScreen("verificationCode",t)}}}]),angular.module("ysSmsVerification.services",[]).service("smsService",["$q","$http",function(e,n){var t={};return t.send=function(){var n=e.defer();return n.resolve({status:"ok"}),n.promise},t.verify=function(t){var i=e.defer();return n.post("/someUrl",t).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise},t}])}();